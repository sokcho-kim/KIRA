# Microsoft 365 MCP

Microsoft 365 ì—°ë™ì„ í†µí•´ KIRAê°€ Outlook, OneDrive, SharePoint, Calendarì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

::: info MS365 MCP
Interactive OAuth ë°©ì‹ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì¸ì¦í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
:::

## ğŸ“‹ ì¤€ë¹„ë¬¼

- Microsoft 365 ê³„ì •
- Azure Portal ì ‘ê·¼ ê¶Œí•œ (ì•± ë“±ë¡ìš©)

---

## ğŸ”‘ 1ë‹¨ê³„: Azure App ë“±ë¡

### 1. Azure Portal ì ‘ì†
1. [Azure Portal](https://portal.azure.com) ì ‘ì†
2. ë¡œê·¸ì¸

### 2. App Registration ìƒì„±
1. ê²€ìƒ‰ì°½ì—ì„œ **"Azure Active Directory"** ê²€ìƒ‰
2. ì™¼ìª½ ë©”ë‰´ì—ì„œ **"App registrations"** í´ë¦­
3. **"New registration"** í´ë¦­

### 3. ì•± ë“±ë¡ ì„¤ì •
- **Name**: `KIRA Bot` (ì›í•˜ëŠ” ì´ë¦„)
- **Supported account types**:
  - ì¡°ì§ ë‚´ë¶€ë§Œ: "Accounts in this organizational directory only"
  - ëª¨ë“  ê³„ì •: "Accounts in any organizational directory"
- **Redirect URI**:
  - **Public client/native**: `http://localhost`
- **"Register"** í´ë¦­

### 4. Application (client) ID ë³µì‚¬
- ìƒì„±ëœ ì•±ì˜ **"Application (client) ID"** ë³µì‚¬
- ë‚˜ì¤‘ì— ì‚¬ìš©

### 5. Tenant ID ë³µì‚¬
- **"Directory (tenant) ID"** ë³µì‚¬
- ë‚˜ì¤‘ì— ì‚¬ìš©

### 6. ì¸ì¦ ì„¤ì • (ì¤‘ìš”!)
1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **"Authentication"** í´ë¦­
2. **"Advanced settings"** ì„¹ì…˜ ì°¾ê¸°
3. **"Allow public client flows"** ë¥¼ **"Yes"** ë¡œ ì„¤ì •
4. **"Save"** í´ë¦­

::: warning Interactive OAuth
MS365 MCPëŠ” Interactive OAuthë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ **Client Secretì´ í•„ìš” ì—†ìŠµë‹ˆë‹¤**.
ëŒ€ì‹  "Allow public client flows"ë¥¼ í™œì„±í™”í•´ì•¼ í•©ë‹ˆë‹¤.
:::

### 7. API Permissions ì„¤ì •
1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **"API permissions"** í´ë¦­
2. **"Add a permission"** í´ë¦­
3. **"Microsoft Graph"** ì„ íƒ
4. **"Delegated permissions"** ì„ íƒ
5. ë‹¤ìŒ ê¶Œí•œ ì¶”ê°€:

   **Mail (Outlook)**
   - âœ… `Mail.Read` - ë©”ì¼ ì½ê¸°
   - âœ… `Mail.ReadWrite` - ë©”ì¼ ì½ê¸°/ì“°ê¸°
   - âœ… `Mail.Send` - ë©”ì¼ ì „ì†¡

   **Files (OneDrive/SharePoint)**
   - âœ… `Files.Read` - íŒŒì¼ ì½ê¸°
   - âœ… `Files.Read.All` - ëª¨ë“  íŒŒì¼ ì½ê¸°
   - âœ… `Files.ReadWrite` - íŒŒì¼ ì½ê¸°/ì“°ê¸°
   - âœ… `Files.ReadWrite.All` - ëª¨ë“  íŒŒì¼ ì½ê¸°/ì“°ê¸°
   - âœ… `Sites.Read.All` - SharePoint ì‚¬ì´íŠ¸ ì½ê¸°
   - âœ… `Sites.ReadWrite.All` - SharePoint ì‚¬ì´íŠ¸ ì½ê¸°/ì“°ê¸°

   **Calendar**
   - âœ… `Calendars.Read` - ìº˜ë¦°ë” ì½ê¸°
   - âœ… `Calendars.ReadWrite` - ìº˜ë¦°ë” ì½ê¸°/ì“°ê¸°

   **User**
   - âœ… `User.Read` - ì‚¬ìš©ì ì •ë³´ ì½ê¸°

6. **"Add permissions"** í´ë¦­

::: tip Admin Consent
ì¡°ì§ ê³„ì •ì¸ ê²½ìš° ê´€ë¦¬ì ìŠ¹ì¸ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
**"Grant admin consent"** ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ìŠ¹ì¸í•˜ì„¸ìš”.
:::

---

## âš™ï¸ 2ë‹¨ê³„: KIRA ì„¤ì •

### 1. KIRA ì•± ì‹¤í–‰
í™˜ê²½ë³€ìˆ˜ ì„¤ì • íƒ­ì„ ì—½ë‹ˆë‹¤.

### 2. Microsoft 365 ì„¹ì…˜ ì°¾ê¸°
**MCP ì„¤ì •** > **Microsoft 365 (Outlook, OneDrive, SharePoint)**

### 3. ì„¤ì • í™œì„±í™”
- í† ê¸€ ìŠ¤ìœ„ì¹˜ë¥¼ **ì¼œê¸°**ë¡œ ë³€ê²½

### 4. Azure ì •ë³´ ì…ë ¥
- **MS365_CLIENT_ID**: Application (client) ID
- **MS365_TENANT_ID**: Directory (tenant) ID

::: info Client Secret ë¶ˆí•„ìš”
MS365 MCPëŠ” Interactive OAuthë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ Client Secretì´ í•„ìš”í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
:::

### 5. ì„¤ì • ì €ì¥
- **"ì„¤ì • ì €ì¥"** ë²„íŠ¼ í´ë¦­
- ì„œë²„ ì¬ì‹œì‘

---

## âœ… 3ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ì§ˆë¬¸ìœ¼ë¡œ ì¸ì¦ ì™„ë£Œ

ì„¤ì •ì„ ì €ì¥í•˜ê³  ì„œë²„ë¥¼ ì‹œì‘í•œ í›„, **í…ŒìŠ¤íŠ¸ ì§ˆë¬¸**ì„ í†µí•´ ì¸ì¦ì„ ì™„ë£Œí•˜ì„¸ìš”.

### í…ŒìŠ¤íŠ¸ ì§ˆë¬¸ ì˜ˆì‹œ
Slackì—ì„œ KIRAì—ê²Œ ë‹¤ìŒê³¼ ê°™ì´ ì§ˆë¬¸í•˜ì„¸ìš”:

```
ìµœê·¼ ë°›ì€ ì´ë©”ì¼ 3ê°œ ë³´ì—¬ì¤˜
```

### ì¸ì¦ ê³¼ì •
1. KIRAê°€ Microsoft 365ì— **ì²˜ìŒ ì ‘ê·¼**í•  ë•Œ ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ ì—´ë¦½ë‹ˆë‹¤
2. Microsoft ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ **ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸**
3. ê¶Œí•œ ìŠ¹ì¸ í™”ë©´ì—ì„œ **"Accept"** í´ë¦­
4. ì¸ì¦ ì™„ë£Œ í›„ **ë¸Œë¼ìš°ì €ë¥¼ ë‹«ì•„ë„ ë©ë‹ˆë‹¤**
5. Slackìœ¼ë¡œ ëŒì•„ê°€ë©´ KIRAê°€ ê²°ê³¼ë¥¼ ì‘ë‹µí•©ë‹ˆë‹¤

::: warning KIRAê°€ ì‹¤í–‰ ì¤‘ì¸ ì»´í“¨í„°ì—ì„œ ì¸ì¦
ë¸Œë¼ìš°ì €ëŠ” **KIRAê°€ ì‹¤í–‰ ì¤‘ì¸ ì»´í“¨í„°**ì—ì„œ ì—´ë¦½ë‹ˆë‹¤. ë³¸ì¸ ì»´í“¨í„°ì—ì„œ ì‹¤í–‰ ì¤‘ì´ë¼ë©´ ë°”ë¡œ ì¸ì¦í•˜ë©´ ë©ë‹ˆë‹¤.
:::

::: tip í•œ ë²ˆë§Œ ì¸ì¦í•˜ë©´ ë©ë‹ˆë‹¤
ì¸ì¦ í† í°ì€ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ë©°, ë‹¤ìŒë¶€í„°ëŠ” ìë™ìœ¼ë¡œ ì¸ì¦ë©ë‹ˆë‹¤.
í† í° ë§Œë£Œ ì‹œ ìë™ìœ¼ë¡œ ê°±ì‹ ë©ë‹ˆë‹¤.
:::

---

## ğŸ¯ ì‚¬ìš© ì˜ˆì‹œ

### ğŸ“§ Outlook - ì´ë©”ì¼

#### ì´ë©”ì¼ ì½ê¸°
```
ì‚¬ìš©ì: ìµœê·¼ ë°›ì€ ì´ë©”ì¼ 5ê°œ ë³´ì—¬ì¤˜
KIRA: [Outlook ì¡°íšŒ]
      1. [ì¤‘ìš”] í”„ë¡œì íŠ¸ ë¯¸íŒ… - í™ê¸¸ë™
      2. ì£¼ê°„ ë¦¬í¬íŠ¸ - ê¹€ì² ìˆ˜
      ...
```

#### ì´ë©”ì¼ ê²€ìƒ‰
```
ì‚¬ìš©ì: "invoice" í‚¤ì›Œë“œë¡œ ì´ë©”ì¼ ê²€ìƒ‰í•´ì¤˜
KIRA: [Outlook ê²€ìƒ‰]
      1. Invoice #1234 - Accounting
      2. Payment Invoice - Finance
```

#### ì´ë©”ì¼ ì „ì†¡
```
ì‚¬ìš©ì: john@company.comì—ê²Œ ì´ë©”ì¼ ë³´ë‚´ì¤˜
      ì œëª©: ë¯¸íŒ… ì¼ì •
      ë‚´ìš©: ë‚´ì¼ ì˜¤í›„ 2ì‹œì— ë¯¸íŒ… ê°€ëŠ¥í•˜ì‹ ê°€ìš”?
KIRA: [Outlook ì „ì†¡] ì´ë©”ì¼ì„ ì „ì†¡í–ˆìŠµë‹ˆë‹¤.
```

#### ì´ë©”ì¼ ë‹µì¥
```
ì‚¬ìš©ì: ê°€ì¥ ìµœê·¼ ì´ë©”ì¼ì— ë‹µì¥í•´ì¤˜: "í™•ì¸í–ˆìŠµë‹ˆë‹¤"
KIRA: [Outlook ë‹µì¥] ë‹µì¥ì„ ì „ì†¡í–ˆìŠµë‹ˆë‹¤.
```

### ğŸ“ OneDrive - íŒŒì¼ ê´€ë¦¬

#### íŒŒì¼ ëª©ë¡
```
ì‚¬ìš©ì: OneDrive ë£¨íŠ¸ í´ë” íŒŒì¼ ëª©ë¡ ë³´ì—¬ì¤˜
KIRA: [OneDrive ì¡°íšŒ]
      1. í”„ë¡œì íŠ¸_ê³„íšì„œ.docx
      2. ì˜ˆì‚°ì•ˆ.xlsx
      3. ë°œí‘œìë£Œ.pptx
```

#### íŒŒì¼ ê²€ìƒ‰
```
ì‚¬ìš©ì: OneDriveì—ì„œ "íšŒì˜ë¡" íŒŒì¼ ì°¾ì•„ì¤˜
KIRA: [OneDrive ê²€ìƒ‰]
      1. 2024_Q1_íšŒì˜ë¡.docx
      2. ì„ì›_íšŒì˜ë¡_0315.pdf
```

#### íŒŒì¼ ë‹¤ìš´ë¡œë“œ
```
ì‚¬ìš©ì: OneDriveì—ì„œ "ê³„ì•½ì„œ.pdf" ë‹¤ìš´ë¡œë“œí•´ì¤˜
KIRA: [OneDrive ë‹¤ìš´ë¡œë“œ] ê³„ì•½ì„œ.pdfë¥¼ ë‹¤ìš´ë¡œë“œí–ˆìŠµë‹ˆë‹¤.
```

### ğŸ“„ SharePoint - í˜‘ì—… ë¬¸ì„œ

#### SharePoint ì‚¬ì´íŠ¸ ëª©ë¡
```
ì‚¬ìš©ì: SharePoint ì‚¬ì´íŠ¸ ëª©ë¡ ë³´ì—¬ì¤˜
KIRA: [SharePoint ì¡°íšŒ]
      1. Team Site - https://blueholestudio.sharepoint.com/team
      2. Project Site - https://blueholestudio.sharepoint.com/project
```

#### SharePoint íŒŒì¼ ê²€ìƒ‰
```
ì‚¬ìš©ì: SharePointì—ì„œ "ë¶„ê¸° ë³´ê³ ì„œ" ì°¾ì•„ì¤˜
KIRA: [SharePoint ê²€ìƒ‰]
      1. Q1_ë³´ê³ ì„œ_ìµœì¢….docx - Team Site
      2. ë¶„ê¸°ë³„_ì‹¤ì _ë³´ê³ ì„œ.xlsx - Project Site
```

### ğŸ“… Calendar - ì¼ì • ê´€ë¦¬

#### ì¼ì • ì¡°íšŒ
```
ì‚¬ìš©ì: ì˜¤ëŠ˜ ì¼ì • ë³´ì—¬ì¤˜
KIRA: [Calendar ì¡°íšŒ]
      1. 10:00 - íŒ€ ë¯¸íŒ… (íšŒì˜ì‹¤ A)
      2. 14:00 - í´ë¼ì´ì–¸íŠ¸ ë¯¸íŒ… (Zoom)
      3. 16:00 - 1:1 ë©´ë‹´
```

#### ì¼ì • ìƒì„±
```
ì‚¬ìš©ì: ë‚´ì¼ ì˜¤í›„ 3ì‹œì— í”„ë¡œì íŠ¸ í‚¥ì˜¤í”„ ë¯¸íŒ… ì¼ì • ì¡ì•„ì¤˜
KIRA: [Calendar ìƒì„±] ì¼ì •ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
```

---

## ğŸ”§ ë¬¸ì œí•´ê²°

### "Authentication failed"
- Client IDì™€ Tenant ID í™•ì¸
- Azure Portalì—ì„œ ì•±ì´ í™œì„±í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸
- "Allow public client flows"ê°€ Yesë¡œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸

### "Insufficient permissions"
- Azure Portal > API Permissions í™•ì¸
- í•„ìš”í•œ ê¶Œí•œì´ ëª¨ë‘ ì¶”ê°€ë˜ì—ˆëŠ”ì§€ í™•ì¸
- Admin Consentê°€ ìŠ¹ì¸ë˜ì—ˆëŠ”ì§€ í™•ì¸

### OAuth ë¸Œë¼ìš°ì €ê°€ ì—´ë¦¬ì§€ ì•ŠìŒ
- ë°©í™”ë²½ì—ì„œ localhost ì°¨ë‹¨ í™•ì¸
- ë¸Œë¼ìš°ì € íŒì—… ì°¨ë‹¨ í•´ì œ
- ë¡œê·¸ì—ì„œ ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸

### "Redirect URI mismatch"
- Azure App Registrationì˜ Redirect URI í™•ì¸
- `http://localhost` ì •í™•íˆ ì…ë ¥
- Platformì´ "Public client/native"ì¸ì§€ í™•ì¸

---

## ğŸ’¡ íŒ

### ë³´ì•ˆ ê°•í™”
- ìµœì†Œ ê¶Œí•œ ì›ì¹™ ì ìš©
- í•„ìš”í•œ ê¶Œí•œë§Œ ë¶€ì—¬
- ì •ê¸°ì ìœ¼ë¡œ ê¶Œí•œ ê²€í† 

### íš¨ìœ¨ì ì¸ ì‚¬ìš©
- SharePoint URLì„ ë¯¸ë¦¬ ì €ì¥í•´ë‘ê¸°
  - ì˜ˆ: `https://blueholestudio-my.sharepoint.com/`
- ì´ë©”ì¼ ê²€ìƒ‰ ì‹œ í‚¤ì›Œë“œ ëª…í™•íˆ ì§€ì •
- OneDrive í´ë” êµ¬ì¡° ì •ë¦¬
- ìë™ ë¶„ë¥˜ ê¸°ëŠ¥ í™œìš©

### ì¡°ì§ ê³„ì • ì‚¬ìš©
- IT ê´€ë¦¬ìì—ê²Œ ì•± ìŠ¹ì¸ ìš”ì²­
- ì¡°ì§ ì •ì±… í™•ì¸
- Multi-factor Authentication ì„¤ì •

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [Azure App Registration ê°€ì´ë“œ](https://docs.microsoft.com/azure/active-directory/develop/quickstart-register-app)
- [Microsoft Graph API](https://docs.microsoft.com/graph/)
